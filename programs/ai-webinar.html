<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Microsoft CAT AI Webinars</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/css/subpage.css" />
    <link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon">
    <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "v9n3ih0g0q");
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <style>
      .play-icon {
        display: inline-block;
        width: 1.2em;
        height: 1.2em;
        background-color: #0C55B8;
        border-radius: 50%;
        position: relative;
        vertical-align: middle;
        margin-right: 0.5em;
      }
      .play-icon::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 52%;
        transform: translate(-50%, -50%);
        width: 0;
        height: 0;
        border-left: 0.5em solid white;
        border-top: 0.3em solid transparent;
        border-bottom: 0.3em solid transparent;
      }
    </style>
  </head>

  <body>
    <header class="header">
      <div class="nav-container">
        <div class="logo-container">
          <div class="logo-line"></div>
          <div class="logo-text">
            Microsoft<br />Copilot Acceleration Team
          </div>
        </div>
      </div>
    </header>

    <main class="main-container">
      <img src="../images/CAT AI Webinar Banner FY26.png" class="responsive" />

      <section class="about-section">
        <div class="hero-details">
          <div class="detail-item">
            <span class="detail-icon">üìÖ</span>
            <span>Most Wednesdays</span>
          </div>
          <div class="detail-item">
            <span class="detail-icon">üïí</span>
            <span>9 AM PT / 12 PM ET / 5 PM GMT</span>
          </div>
          <div class="detail-item">
            <span class="detail-icon">‚è±Ô∏è</span>
            <span>60-90 minute sessions</span>
          </div>
        </div>
      </section>

      <div class="sessions-container" style="margin-top: 2rem; grid-template-columns: repeat(2, 1fr);">
        <div class="session-card" style="aspect-ratio: auto; background-color: white;">
          <div class="session-content">
            <h2 class="section-title" style="margin-top: 0;">About the Webinar Series</h2>
            <p class="about-text">
              Microsoft CAT AI Webinars are a series of interactive virtual
              sessions designed to help your organization adopt Microsoft Copilot
              and agents.
            </p>
            <p class="about-text">
              In these sessions you'll engage with Microsoft experts and other
              customers to gain the knowledge and skills needed to successfully
              adopt and thrive with agents in your organization.
            </p>
          </div>
        </div>
        <div class="session-card" style="aspect-ratio: auto; background-color: #f0f8ff;" id="next-session-card">
          <div class="session-content">
            <div class="session-date">
              <span class="session-date-icon">üìÖ</span>
              <span>Next Session</span>
            </div>
            <h3 class="session-title" style="font-size: 1.8rem;" id="next-session-title">
              Loading...
            </h3>
            <p id="next-session-description"></p>
            <a href="#" class="register-btn" style="background-color: white; color: #1A3985; border: 2px solid #1A3985; display: none;" id="next-session-link" target="_blank" rel="noopener noreferrer"
              >Register Now</a
            >
          </div>
        </div>
      </div>

      <div style="margin-top: 4rem;">
        <h2 class="section-title">What to Expect</h2>
        <ul class="expect-list">
          <li class="expect-item">
            Gain the strategic expertise your organizations needs to succeed with
            Microsoft Copilot.
          </li>
          <li class="expect-item">
            Explore the possibilities of Microsoft Copilot,
            advancements with autonomous agents, and more.
          </li>
          <li class="expect-item">
            Engage in interactive exercises that allow you to
            learn from others.
          </li>
        </ul>
      </div>

      <h2 class="section-title" style="margin-top: 4rem;">Upcoming Sessions</h2>
      <div class="sessions-container" id="upcoming-sessions-container">
        <!-- Populated by JavaScript -->
      </div>

      <h2 class="section-title" style="margin-top: 4rem;"><span class="play-icon"></span>Past Sessions</h2>
      <p class="about-text" style="margin-bottom: 1.5rem;">
        Watch the recordings and download the presentations of previous sessions.
      </p>
      <div id="past-sessions-container">
        <!-- Populated by JavaScript -->
      </div>
    </main>

    <footer class="footer">
      <div class="footer-container">
        <div class="footer-logo">
          <div class="footer-logo-line"></div>
          <div class="footer-logo-text">Microsoft CAT</div>
        </div>
        <div class="footer-copyright">
          ¬© 2025 Microsoft Corporation. All rights reserved.
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        try {
          const response = await fetch('ai-webinar-sessions.yml');
          if (!response.ok) throw new Error('Failed to fetch sessions YAML');
          const yamlText = await response.text();
          const data = jsyaml.load(yamlText);
          const sessions = data.sessions;
          const now = new Date();

          // Parse dates and classify each session
          const sessionData = sessions.map(session => {
            const [year, month, day] = session.date.split('-').map(Number);
            const displayDate = new Date(year, month - 1, day);
            // Session expires 2 hours after the 9 AM PT start = 11 AM PT
            const cutoffStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}T11:00:00-08:00`;
            const cutoffDate = new Date(cutoffStr);
            return { ...session, displayDate, cutoffDate };
          });

          // Sort all sessions chronologically
          sessionData.sort((a, b) => a.cutoffDate - b.cutoffDate);

          const upcoming = sessionData.filter(s => s.cutoffDate > now);
          const past = sessionData.filter(s => s.cutoffDate <= now).reverse(); // most recent first

          // --- Next Session card ---
          const nextSessionLink = document.getElementById('next-session-link');
          if (upcoming.length > 0) {
            const next = upcoming[0];
            document.getElementById('next-session-title').textContent = next.title;
            const formattedDate = next.displayDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric' });
            document.getElementById('next-session-description').innerHTML =
              `${escapeHtml(formattedDate)} &bull; ${escapeHtml(next.time || '9AM PT')}<br><br>${escapeHtml(next.description)}`;
            nextSessionLink.href = next.register_link || '#';
            nextSessionLink.style.display = '';
          } else {
            document.getElementById('next-session-title').textContent = 'No Upcoming Sessions';
            document.getElementById('next-session-description').textContent = 'Check back soon for new session announcements!';
            nextSessionLink.style.display = 'none';
          }

          // --- Upcoming Sessions (skip the first, already shown in Next Session card) ---
          const upcomingContainer = document.getElementById('upcoming-sessions-container');
          const upcomingToShow = upcoming.slice(1);
          if (upcomingToShow.length === 0) {
            upcomingContainer.innerHTML = '<p style="grid-column: 1 / -1; color: #666; padding: 0.5rem 0;">No additional upcoming sessions at this time. Check back soon!</p>';
          } else {
            upcomingToShow.forEach(session => {
              upcomingContainer.appendChild(createUpcomingCard(session));
            });
          }

          // --- Past Sessions ---
          const pastContainer = document.getElementById('past-sessions-container');
          if (past.length === 0) {
            pastContainer.innerHTML = '<p style="color: #666; padding: 0.5rem 0;">No past sessions yet.</p>';
          } else {
            past.forEach(session => {
              pastContainer.appendChild(createPastRow(session));
            });
          }

        } catch (error) {
          console.error('Failed to load sessions:', error);
          document.getElementById('next-session-title').textContent = 'Unable to load sessions';
          document.getElementById('next-session-description').textContent = 'Please try refreshing the page.';
        }
      });

      function formatSessionDate(dateStr) {
        const [year, month, day] = dateStr.split('-').map(Number);
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                            'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        return `${monthNames[month - 1]} ${day}`;
      }

      function escapeHtml(str) {
        if (!str) return '';
        const div = document.createElement('div');
        div.appendChild(document.createTextNode(str));
        return div.innerHTML;
      }

      function createUpcomingCard(session) {
        const card = document.createElement('div');
        card.className = 'session-card';
        const dateDisplay = formatSessionDate(session.date) + (session.time ? ' \u2022 ' + session.time : '');
        const registerBtn = session.register_link
          ? `<a href="${session.register_link}" class="register-btn" style="background-color: #0C55B8;" target="_blank" rel="noopener noreferrer">Register Now</a>`
          : '';
        card.innerHTML = `
          <div class="session-content">
            <div class="session-date"><span>${escapeHtml(dateDisplay)}</span></div>
            <h3 class="session-title">${escapeHtml(session.title)}</h3>
            <p>${escapeHtml(session.description)}</p>
            ${registerBtn}
          </div>`;
        return card;
      }

      function createPastRow(session) {
        const row = document.createElement('div');
        row.style.cssText = 'display: flex; align-items: center; gap: 1.5rem; padding: 0.85rem 0; border-bottom: 1px solid #e0e0e0; flex-wrap: wrap;';
        let buttons = '';
        if (session.recording_link) {
          buttons += `<a href="${session.recording_link}" style="color: #0C55B8; white-space: nowrap;" target="_blank" rel="noopener noreferrer">Recording</a>`;
        } else {
          buttons += `<span style="color: #999; white-space: nowrap;">Recording Coming Soon</span>`;
        }
        if (session.presentation_link) {
          const label = escapeHtml(session.presentation_label || 'Presentation');
          buttons += ` &nbsp;|&nbsp; <a href="${session.presentation_link}" style="color: #0C55B8; white-space: nowrap;" target="_blank" rel="noopener noreferrer">${label}</a>`;
        }
        row.innerHTML = `
          <span style="min-width: 5rem; color: #506CD4; font-weight: 600; font-size: 0.9rem;">${escapeHtml(formatSessionDate(session.date))}</span>
          <span style="flex: 1; font-weight: 500;">${escapeHtml(session.title)}</span>
          <span style="display: flex; gap: 0.5rem; flex-shrink: 0;">${buttons}</span>`;
        return row;
      }
    </script>
  </body>
</html>
